*** ActivityManagerService.smali	2013-07-12 21:42:32.448499120 +0000
--- ActivityManagerService.smali	2013-07-12 21:40:27.935155520 +0000
***************
*** 1351,1356 ****
      .local v1, systemDir:Ljava/io/File;
      invoke-virtual {v1}, Ljava/io/File;->mkdirs()Z
  
      new-instance v2, Lcom/android/server/am/BatteryStatsService;
  
      new-instance v3, Ljava/io/File;
--- 1355,1362 ----
      .local v1, systemDir:Ljava/io/File;
      invoke-virtual {v1}, Ljava/io/File;->mkdirs()Z
  
+     invoke-static {}, Lcom/android/server/am/ExtraActivityManagerService;->init()V
+ 
      new-instance v2, Lcom/android/server/am/BatteryStatsService;
  
      new-instance v3, Ljava/io/File;
***************
*** 8438,8448 ****
      const/16 v23, 0x0
  
      .local v23, interesting:Z
!     move-object/from16 v0, p1
  
!     move-object/from16 v1, p3
  
!     if-ne v0, v1, :cond_16
  
      const/4 v11, 0x0
  
--- 8460,8476 ----
      const/16 v23, 0x0
  
      .local v23, interesting:Z
!     move-object/from16 v0, p0
  
!     move-object/from16 v1, p1
! 
!     move-object/from16 v2, p3
! 
!     invoke-static {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService$Injector;->isForegroudApp(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/ProcessRecord;)Z
! 
!     move-result v2
  
!     if-eqz v2, :cond_16
  
      const/4 v11, 0x0
  
***************
*** 10770,10775 ****
  
      invoke-virtual {v12, v3, v0}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
  
      iput-object v12, v15, Landroid/os/Message;->obj:Ljava/lang/Object;
  
      move-object/from16 v0, p0
--- 10801,10812 ----
  
      invoke-virtual {v12, v3, v0}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
  
+     const-string v3, "crash"
+ 
+     move-object/from16 v0, p2
+ 
+     invoke-virtual {v12, v3, v0}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
+ 
      iput-object v12, v15, Landroid/os/Message;->obj:Ljava/lang/Object;
  
      move-object/from16 v0, p0
***************
*** 20027,20033 ****
      move-result-object v1
  
      .local v1, context:Landroid/content/Context;
!     const v4, 0x103006b
  
      invoke-virtual {v1, v4}, Landroid/content/Context;->setTheme(I)V
  
--- 20067,20073 ----
      move-result-object v1
  
      .local v1, context:Landroid/content/Context;
!     const v4, 0x60d003a
  
      invoke-virtual {v1, v4}, Landroid/content/Context;->setTheme(I)V
  
***************
*** 43891,43896 ****
  
      invoke-direct/range {v2 .. v16}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZIII)I
  
      .end local v19           #nmsg:Landroid/os/Message;
      :cond_1
      monitor-exit p0
--- 43931,43942 ----
  
      invoke-direct/range {v2 .. v16}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZIII)I
  
+     move-object/from16 v0, p0
+ 
+     iget-object v2, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
+ 
+     invoke-static {v2}, Lcom/android/server/am/ExtraActivityManagerService;->finishBooting(Landroid/content/Context;)V
+ 
      .end local v19           #nmsg:Landroid/os/Message;
      :cond_1
      monitor-exit p0
